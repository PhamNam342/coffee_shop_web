<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Qu·∫£n l√Ω Voucher - Qu√°n c√† ph√™</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body { background: linear-gradient(to bottom, #f6f1ed, #fff9f0); font-family: 'Segoe UI', sans-serif; }
    .sidebar { min-height: 100vh; background: linear-gradient(to bottom, #6f4e37, #3e2723); padding-top: 20px; }
    .sidebar a { color: #fff; text-decoration: none; display: block; padding: 12px 20px; font-weight: 500; border-radius: 8px; margin: 5px 10px; transition: 0.3s; }
    .sidebar a:hover { background: #8d6e63; }
    .content { padding: 20px; }
    .coffee-bg { background: #fdfaf6; padding: 30px; border-radius: 12px; }
    .text-coffee { color: #6f4e37; }
    .btn-coffee { background-color: #6f4e37; color: white; border: none; transition: 0.3s; }
    .btn-coffee:hover { background-color: #5a3e2d; transform: translateY(-2px); }
    .customer-box { display: grid; grid-template-columns: 1fr 1fr; gap: 10px 20px; max-height: 600px; overflow-y: auto; }
    .customer-item:hover { background-color: #f5f0eb; }
    .phone { font-family: "Roboto Mono", monospace; font-size: 14px; color: #444; }
    .table thead { background-color: #6f4e37 !important; color: #fff !important; }
    @media (max-width:768px){ .row > .col-md-4,.row > .col-md-8{flex:0 0 100%;max-width:100%;margin-bottom:20px;} }
  </style>
</head>
<body>
<div class="container-fluid">
  <div class="row">
    <!-- Sidebar -->
    <nav class="col-md-2 d-none d-md-block sidebar">
        <div class="pt-3">
          <h5 class="text-white text-center mb-4">‚òï Admin</h5>
          <a href="#"><i class="fa-solid fa-house me-2"></i>Dashboard</a>
          <a href="/admin/orders"><i class="fa-solid fa-receipt me-2"></i>Qu·∫£n l√Ω ƒë∆°n h√†ng</a>
          <a href="/admin/menu"><i class="fa-solid fa-mug-saucer me-2"></i>Qu·∫£n l√Ω m√≥n</a>
          <a href="/admin/customer"><i class="fa-solid fa-user me-2"></i>Kh√°ch h√†ng</a>
          <a href="/admin/shift"><i class="fa-solid fa-clock me-2"></i>Ca l√†m</a>
          <a href="/admin/voucher"><i class="fa-solid fa-ticket me-2"></i>Voucher</a>
          <a href="/admin/employee"><i class="fa-solid fa-user-tie me-2"></i>Nh√¢n vi√™n</a>
          <a href="/admin/statistic"><i class="fa-solid fa-chart-line me-2"></i>Th·ªëng k√™</a>
          <a href="/logout"><i class="fa-solid fa-door-open me-2"></i>ƒêƒÉng xu·∫•t</a>
        </div>
      </nav>

    <!-- Main content -->
    <main class="col-md-10 ms-sm-auto col-lg-10 content">
      <div class="coffee-bg mt-2">
        <h2 class="mb-4 text-center text-coffee fw-bold">‚òï T·∫°o Voucher M·ªõi</h2>

        <form method="POST" action="/admin/voucher">
          <div class="row g-4">
            <!-- Ch·ªçn kh√°ch h√†ng -->
            <div class="col-md-4">
              <label class="form-label fw-bold text-coffee">üë• Ch·ªçn kh√°ch h√†ng</label>
              <input type="text" id="searchCustomer" class="form-control form-control-lg mb-3"
                     placeholder="üîç T√¨m theo t√™n ho·∫∑c s·ªë ƒëi·ªán tho·∫°i...">
              <div class="border rounded p-3 bg-light shadow-sm customer-box" id="customerList">
                {% for cust in customers %}
                <div class="customer-item mb-2">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="customers" value="{{ cust[0] }}" id="cust{{ cust[0] }}">
                    <label class="form-check-label w-100" for="cust{{ cust[0] }}">
                      <span class="fw-bold text-coffee">{{ cust[1] }}</span>
                      <small class="phone">({{ cust[2] }})</small>
                    </label>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>

            <!-- Form voucher -->
            <div class="col-md-8">
              <div class="card p-5 shadow-lg border-0 rounded-4">
                <div class="mb-4">
                  <label class="form-label fw-bold text-coffee">üè∑Ô∏è M√£ Voucher</label>
                  <input type="text" name="code" class="form-control form-control-lg" placeholder="Nh·∫≠p m√£ (ho·∫∑c ƒë·ªÉ tr·ªëng)">
                </div>
                <div class="mb-4">
                  <label class="form-label fw-bold text-coffee">üíµ Gi·∫£m gi√° (USD)</label>
                  <input type="number" step="0.01" name="discount_usd" class="form-control form-control-lg" required>
                </div>
                <div class="mb-4">
                  <label class="form-label fw-bold text-coffee">üìÖ Ng√†y h·∫øt h·∫°n</label>
                  <input type="date" name="expiry_date" class="form-control form-control-lg" required>
                </div>
                <div class="mb-4">
                  <label class="form-label fw-bold text-coffee">üìù M√¥ t·∫£</label>
                  <textarea name="description" class="form-control form-control-lg" rows="4"></textarea>
                </div>
                <div class="text-end">
                  <button class="btn btn-coffee btn-lg px-5 py-2 rounded-3 shadow-sm" type="submit">‚úÖ T·∫°o Voucher</button>
                </div>
              </div>
            </div>
          </div>
        </form>

        <!-- Danh s√°ch voucher -->
        <div class="mt-5">
          <h3 class="text-coffee fw-bold">üìú Danh s√°ch Voucher</h3>
          <div class="table-responsive">
            <table class="table table-hover table-striped mt-3 shadow-sm rounded-3 align-middle">
              <thead>
                <tr>
                  <th>M√£ Voucher</th>
                  <th class="text-center">Gi·∫£m gi√°</th>
                  <th class="text-center">Ng√†y h·∫øt h·∫°n</th>
                  <th>M√¥ t·∫£</th>
                  <th>Kh√°ch h√†ng √°p d·ª•ng</th>
                </tr>
              </thead>
              <tbody>
                {% for v in vouchers %}
                <tr>
                  <td class="fw-bold">{{ v.code }}</td>
                  <td class="text-center">${{ v.discount_usd }}</td>
                  <td class="text-center">{{ v.expiry_date }}</td>
                  <td>{{ v.description }}</td>
                  <td>{{ v.customer_names }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>

<script>
document.getElementById('searchCustomer').addEventListener('input', function() {
  let keyword = this.value.toLowerCase();
  document.querySelectorAll('.customer-item').forEach(item => {
    let name = item.querySelector('span').innerText.toLowerCase();
    let phone = item.querySelector('.phone').innerText.toLowerCase();
    item.style.display = (name.includes(keyword) || phone.includes(keyword)) ? '' : 'none';
  });
});
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
